!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("@yfmd/wavesurfer.js")):"function"==typeof define&&define.amd?define(["react","@yfmd/wavesurfer.js"],e):"object"==typeof exports?exports["plugins/timeline"]=e(require("react"),require("@yfmd/wavesurfer.js")):(t.Wavesurfer=t.Wavesurfer||{},t.Wavesurfer["plugins/timeline"]=e(t.React,t.WaveSurfer))}(this,function(t,e){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),l=r(2),h=i(l),c=r(4),f=i(c);r(8);var p=function(t){function e(t){n(this,e);var r=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.timeline=null,r}return a(e,t),o(e,[{key:"componentDidMount",value:function(){this.props.isReady&&this.init(),this.props.wavesurfer.on("ready",this._init.bind(this))}},{key:"_init",value:function(){this.timeline=Object.create(WaveSurfer.Timeline),this.timeline.init((0,f.default)({},this.props.options,{container:this.timelineEl,wavesurfer:this.props.wavesurfer}))}},{key:"render",value:function(){var t=this;return h.default.createElement("div",{ref:function(e){t.timelineEl=e}})}}]),e}(l.Component);p.propTypes={isReady:l.PropTypes.bool.isRequired,options:l.PropTypes.object.isRequired,wavesurfer:l.PropTypes.object},p.defaultProps={isReady:!1,options:{}},e.default=p},function(t,e){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){"use strict";function i(t){if(null===t||void 0===t)throw new TypeError("Sources cannot be null or undefined");return Object(t)}function n(t,e,r){var i=e[r];if(void 0!==i&&null!==i){if(o.call(t,r)&&(void 0===t[r]||null===t[r]))throw new TypeError("Cannot convert undefined or null to object ("+r+")");o.call(t,r)&&a(i)?t[r]=s(Object(t[r]),e[r]):t[r]=i}}function s(t,e){if(t===e)return t;e=Object(e);for(var r in e)o.call(e,r)&&n(t,e,r);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),s=0;s<i.length;s++)l.call(e,i[s])&&n(t,e,i[s]);return t}var a=r(5),o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;t.exports=function(t){t=i(t);for(var e=1;e<arguments.length;e++)s(t,arguments[e]);return t}},function(t,e){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){var e="undefined"==typeof t?"undefined":r(t);return null!==t&&("object"===e||"function"===e)}},,,function(t,e,r){(function(t){var e=!1,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n,s){"function"==typeof e&&e.amd?e(["wavesurfer"],function(t){return s(t)}):"object"===i(t)&&t.exports?t.exports=s(r(3)):s(n.WaveSurfer)}(void 0,function(t){"use strict";t.Timeline={init:function(t){this.params=t;var e=this.wavesurfer=t.wavesurfer;if(!this.wavesurfer)throw Error("No WaveSurfer instance provided");var r=this.drawer=this.wavesurfer.drawer;if(this.container="string"==typeof t.container?document.querySelector(t.container):t.container,!this.container)throw Error("No container for WaveSurfer timeline");this.width=r.width,this.pixelRatio=this.drawer.params.pixelRatio,this.maxCanvasWidth=r.maxCanvasWidth||this.width,this.maxCanvasElementWidth=r.maxCanvasElementWidth||Math.round(this.maxCanvasWidth/this.pixelRatio),this.height=this.params.height||20,this.notchPercentHeight=this.params.notchPercentHeight||90,this.primaryColor=this.params.primaryColor||"#000",this.secondaryColor=this.params.secondaryColor||"#c0c0c0",this.primaryFontColor=this.params.primaryFontColor||"#000",this.secondaryFontColor=this.params.secondaryFontColor||"#000",this.fontFamily=this.params.fontFamily||"Arial",this.fontSize=this.params.fontSize||10,this.timeInterval=this.params.timeInterval,this.primaryLabelInterval=this.params.primaryLabelInterval,this.secondaryLabelInterval=this.params.secondaryLabelInterval,this.formatTimeCallback=this.params.formatTimeCallback,this.canvases=[],this.createWrapper(),this.render(),r.wrapper.addEventListener("scroll",function(t){this.updateScroll(t)}.bind(this)),this._onRedraw=e.on("ready",this.render.bind(this)),this._onZoom=e.on("zoom",this.render.bind(this)),this._onDestroy=e.on("destroy",this.destroy.bind(this)),e.un("audioprocess",this.resetTimeline.bind(this)),e.on("audioprocess",this.resetTimeline.bind(this))},resetTimeline:function(){if(!this.container.children.length&&!isNaN(this.wavesurfer.getDuration())){var t=Object.create(this);t.init(this.params),this.wavesurfer.fireEvent("reset")}},destroy:function(){this._onRedraw.un(),this._onZoom.un(),this._onDestroy.un(),this.unAll(),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)},createWrapper:function(){var t=this.container.querySelector("timeline");t&&this.container.removeChild(t);var e=this.wavesurfer.params;this.wrapper=this.container.appendChild(document.createElement("timeline")),this.drawer.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.height+"px"}),(e.fillParent||e.scrollParent)&&this.drawer.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"});var r=this;this.wrapper.addEventListener("click",function(t){t.preventDefault();var e="offsetX"in t?t.offsetX:t.layerX;r.fireEvent("click",e/r.wrapper.scrollWidth||0)})},removeOldCanvases:function(){for(;this.canvases.length>0;){var t=this.canvases.pop();t.parentElement.removeChild(t)}},createCanvases:function(){this.removeOldCanvases();for(var t,e=Math.round(this.drawer.wrapper.scrollWidth),r=Math.ceil(e/this.maxCanvasElementWidth),i=0;i<r;i++)t=this.wrapper.appendChild(document.createElement("canvas")),this.canvases.push(t),this.drawer.style(t,{position:"absolute",zIndex:4})},render:function(){this.createCanvases(),this.updateCanvasStyle(),this.drawTimeCanvases()},updateCanvasStyle:function(){for(var t=this.canvases.length,e=0;e<t;e++){var r=this.canvases[e],i=this.maxCanvasElementWidth;e===t-1&&(i=this.drawer.wrapper.scrollWidth-this.maxCanvasElementWidth*(t-1)),r.width=i*this.pixelRatio,r.height=this.height*this.pixelRatio,r.style.width=i+"px",r.style.height=this.height+"px",r.style.left=e*this.maxCanvasElementWidth+"px"}},drawTimeCanvases:function(){var t=this.wavesurfer.backend,e=this.wavesurfer.params,r=t.getDuration(),i=this;if(e.fillParent&&!e.scrollParent)var n=this.drawer.getWidth();else n=this.drawer.wrapper.scrollWidth*e.pixelRatio;var s=n/r;if(r<=0||isNaN(r)){var a=this.container.querySelector("timeline");return void(a&&this.container.removeChild(a))}var o=0,l=0,h=parseInt(r,10)+1,c=function(t){if("function"==typeof i.formatTimeCallback)return i.formatTimeCallback(t);if(t/60>1){var e=parseInt(t/60),t=parseInt(t%60);return t=t<10?"0"+t:t,""+e+":"+t}return t};if(1*s>=25)var f=1,p=10,u=5;else if(5*s>=25)var f=5,p=6,u=2;else if(15*s>=25)var f=15,p=4,u=2;else var f=60,p=4,u=2;f=this.timeInterval||f,p=this.primaryLabelInterval||p,u=this.secondaryLabelInterval||u;for(var d=this.height-4,v=this.height*(this.notchPercentHeight/100)-4,y=this.fontSize*e.pixelRatio,m=0;m<h/f;m++)m%p==0?(this.setFillStyles(this.primaryColor),this.fillRect(o,0,1,d),this.setFonts(y+"px "+this.fontFamily),this.setFillStyles(this.primaryFontColor),this.fillText(c(l),o+5,d)):m%u==0?(this.setFillStyles(this.secondaryColor),this.fillRect(o,0,1,d),this.setFonts(y+"px "+this.fontFamily),this.setFillStyles(this.secondaryFontColor),this.fillText(c(l),o+5,d)):(this.setFillStyles(this.secondaryColor),this.fillRect(o,0,1,v)),l+=f,o+=s*f},setFillStyles:function(t){for(var e in this.canvases)this.canvases.hasOwnProperty(e)&&(this.canvases[e].getContext("2d").fillStyle=t)},setFonts:function(t){for(var e in this.canvases)this.canvases.hasOwnProperty(e)&&(this.canvases[e].getContext("2d").font=t)},fillRect:function(t,e,r,i){for(var n in this.canvases)if(this.canvases.hasOwnProperty(n)){var s=this.canvases[n],a=n*this.maxCanvasWidth,o={x1:Math.max(t,n*this.maxCanvasWidth),y1:e,x2:Math.min(t+r,n*this.maxCanvasWidth+s.width),y2:e+i};o.x1<o.x2&&s.getContext("2d").fillRect(o.x1-a,o.y1,o.x2-o.x1,o.y2-o.y1)}},fillText:function(t,e,r){var i,n=0;for(var s in this.canvases)if(this.canvases.hasOwnProperty(s)){var a=this.canvases[s].getContext("2d"),o=a.canvas.width;if(n>e+i)break;n+o>e&&(i=a.measureText(t).width,a.fillText(t,e-n,r)),n+=o}},updateScroll:function(){this.wrapper.scrollLeft=this.drawer.wrapper.scrollLeft}},t.util.extend(t.Timeline,t.Observer)})}).call(e,r(1)(t))}])});